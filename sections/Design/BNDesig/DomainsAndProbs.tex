\section{Domains and Probability}\label{MID}
The purpose of the model is to predict \texttt{Vector\_2} when given information
about \texttt{Vector\_1}. In order to do this, we need to model how the two
vectors relate to each other, and how they are affected by information about the
targets location. The first step to this approach is to define what this
information's domains is, that is, how the data is represented and used.
There are however limitations we need to consider in relation to the
implementation of this model. The model is constructed using Hugin Lite
\citep{Hugin} which allows it to be constructed easily, but it limits the total
number of states to 50 and the number of cases to 500. For our model, an example
of a case, is a specific value in \texttt{SD\_0} given a specific value in
\texttt{Vector\_1}. This means, that in order to represent our vectors and
observations of the target, we need to simplify this information in order to
fit the model. While this decreases the accuracy of the model, it is necessary
for implementing it given the limitations. For example, if we want to model the
entire domain for the distance, we would need a state for each possible value
the domain contains. To work around these limits we have divided the domains
for the observations and vectors into intervals.\nl

Most of the domains are easy to determine, for instance the domains for each of
the sensors are determined by what they can output. As such the domain for
distance has values between 0 and 255cm, as this is what the ultrasound sensor
can sense. This domain is divided into 5 intervals, with the first and the last
intervals being the biggest. This ensures that we can have improved precision
for the remaining 3 intervals. The domain for angle is determined by how far the
turret can turn, which is 360 degrees. It is of note that the angle is set as 0
at the start of program, which results in a negative angle if it turns towards the target at the
start, instead of following it. This means that domain for sensing the angle is
adjusted slight to -30 to 330 degrees. These domains for the angles and
distances are shown below in \autoref{distAngleDom}. 

\begin{table}[H]
\centering
\begin{tabular}{l|l|l}
State & Angle (deg) & Distance (cm) \\ \hline
1     & -30 - 0     & 0 - 60        \\
2     & 0 - 30      & 60 - 75       \\
3     & 30 - 60     & 75 - 90       \\
4     & 60 - 90     & 90 - 105      \\
5     & 90 - 330    & 105 - 255     
\end{tabular}
\caption{Domains for angles and distances respectively.}
\label{distAngleDom}
\end{table}

\fix{}{dobbelt tjek target hastighed}
The states for the vectors consist of the percieved speed of the target, that
is, how far along the x and y-axis it has moved per millisecond. These vectors
were determined as an average of vectors which were \fix{reasonable close}{hvad
er close?} to the expected speed. They are for simplicity denoted by how fast
the target is moving, 35cm/s, 50cm/s and when it is a 'bad vector', referred to as
\textbf{BV}. A 'bad vector' is a vector that is exceeds this difference from
the expected vector. If an additional vector is added, one that does not drive
perpendicular in front of it, we would need to denote them by their actual
vector for clarity. The vectors are limited to 3 states, as 1 additional vector
will result in 98 additional cases, due to all the other nodes depending on the
vectors. The domain for the vectors are presented in \autoref{vecDom}.

\begin{table}[H]
\centering
\begin{tabular}{l|l}
State & Vector \\ \hline
1     & 35cm/s \\
2     & 50cm/s \\
3     & BV
\end{tabular}
\caption{Domain for the vectors.}
\label{vecDom}
\end{table}

Using this simplified approach means the model lose some precision, but it
allows us to work around the limit of 500 cases. Instead of having only a few
nodes with a continuous set of values, we can consider additional variables,
which can make up for the loss of accuracy. It also allows us group the values
that seem unlikely to be used often into big intervals.

\subsection{Learning the Beliefs}

By adding an
evidence to one of the sensor nodes, we can infere the likelyhood of given
vector variables. The more nodes are filled with evidence, the clearer we can
infere which vector the target is using to travel.


For each speed we want to implement in the model, we need a dataset which is
based on the sensor readings from turret for that speed, see
\autoref{AppendixMIData}. This allows us to create a series of vectors which we
can used to fill the conditional probability tables. This is done by taking each
observation, such as distance or angle, and comparing it to the expected vector.
For instance, we observe an observation at time 0 in the 80\% set which has a
distance of 94, we then look at the corresponding V1 and see that it is
classified as an accepted vector for 80\%. We can then note this in the
conditional probability table for \texttt{SD\_0|Vector\_1}. After this is
done for both sets of tests we have constructed the table
which can be seen in \autoref{SDtable}. For instance, there are a total of 9
times the distance between the target and turret were in the [60-75] interval
out of the 22 times distance was used by a viable 50cm/s vector. As such, the
probability table for \texttt{SD\_0} and \texttt{SD\_2} can be seen in seen
\autoref{SDtable}. While it seems there is little difference in the
probabilities distribution, this can most likely be attributed to sample size
and how big the intervals are.

\begin{table}[H]
\centering
\begin{tabular}{|l|l|l|l|}
\hline
\multicolumn{4}{|l|}{P(SD\_0|Vector\_1)} \\ \hline
Vector\_1     & 50cm/s & BV & 35cm/s \\\hline 
[0 - 60]      & 3/22 = 0.14 & 3/27 = 0.11 & 0 \\ \hline 
[60 - 75]    & 9/22 = 0.41 & 12/27 = 0.44 & 14/24 = 0.58 \\ \hline
[75 - 90]   & 5/22 = 0.23 & 8/27 = 0.30 & 6/24 = 0.25 \\ \hline
[90 - 105]   & 4/22 = 0.18 & 1/27 = 0.04 & 3/24 = 0.13 \\ \hline
[105 - 255]   & 1/22 =0.04 & 3/22 = 0.11 & 1/24 = 0.04   \\ \hline
\end{tabular}
\caption{The conditional probability table for sensing the distance given the
vector.}
\label{SDtable}
\end{table}

  
\texttt{SD\_1} is a special case, since it is dependent on both
\texttt{Vector\_1} and \texttt{Vector\_2}, this can be seen in
\autoref{SDtable2}. This means that we need to consider how the observation
relates to both of the vectors it is used to create.

\begin{table}[H]
\centering
\begin{tabular}{|l|p{1.2cm}|p{1.2cm}|l|p{1.2cm}|p{1.2cm}|p{1.2cm}|l|p{1.2cm}|p{1.2cm}|}
\hline
\multicolumn{10}{|l|}{P(SD\_1|Vector\_1, Vector\_2)} \\\hline 
Vector\_2 & \multicolumn{3}{l|}{50cm/s} & \multicolumn{3}{l|}{BV} &
\multicolumn{3}{l|}{35cm/s}\\\hline 
Vector\_1 & 50cm/s      &  BV     & 35cm/s      & 50cm/s      & BV      & 35cm/s     
& 50cm/s & BV & 35cm/s \\\hline
[0-60]&1/12 = 0.08 & 1/3 = 0.33 & 0      & 2/12 = 0.17 & 1/6 = 0.17 & 0 & 0  
& 0 & 0 \\ \hline
[60-75]&4/12 = 0.33 & 1/3 = 0.33 & 1      & 7/12 = 0.58 & 3/6 = 0.5 & 0      & 1     
& 7/15 = 0.47 & 5/9 = 0.56\\ \hline
[75-90] & 4/12 = 0.33 & 0 & 0 & 2/12 = 0.17 & 1/6 = 0.17 & 2/3 = 0.67 & 0 
& 5/15 = 0.33 &1/9 = 0.11\\\hline
[90-105] & 2/12 = 0.17 & 1/3 = 0.33 & 0 & 1/12 = 0.08 & 0 & 0 & 0 
& 2/15 = 0.07  & 3/9 = 0.33\\\hline
[105-255] & 1/12 = 0.08 & 0 & 0 & 0 & 1/6 = 0.17 & 1/3 = 0.33 & 0 & 1/15 = 0.07     
&0\\\hline
\end{tabular}
\caption{The conditional probability table for sensing the distance given two
vectors.}
\label{SDtable2}
\end{table}

Similar tables are made for \texttt{SA\_0-2}, these can be seen in \autoref{PT}.
The probability distribution of vectors is seen below in \autoref{Vector0Table},
here it is seen that\ldots \fix{}{Create a quick distribution}.



\begin{table}[H]
\centering
\begin{tabular}{|l|l|}
\hline
P(Vector\_1) &\\ \hline
50cm/s & 13/33 = 0.39   \\ \hline 
BV & 7/33 = 0.22  \\ \hline
35cm/s & 13/33 = 0.39  \\ \hline
\end{tabular}
\caption{The probability table for a Vector\_1}
\label{Vector0Table}
\end{table}

\texttt{Vector\_2} is given as the following conditional probability table, see
\autoref{Vector2tab}. the table shows the likelyhood of the second vector
changing from one state to another. It can be seen that it is up to a coin toss
whether the secondary vector can be used if the first vector is a 80\% vector.
It also shows that it is far more likely for 60\% to provide consistently good
data.

\begin{table}[]
\centering
\begin{tabular}{|l|l|l|l|}
\hline
\multicolumn{4}{|l|}{P(Vector\_2|Vector\_1)} \\ \hline
 Vector\_1 & 50cm/s    & BV    & 35cm/s    \\ \hline
 50cm/s    & 4/8 = 0.5    & 1/8 = 0.13    & 0    \\ \hline
 BV   & 4/8 = 0.5    & 2/8 = 0.25    & 1/4 = 0.25  \\ \hline
 35cm/s    & 0            & 5/8 = 0.62    & 3/4 = 0.75  \\ \hline
\end{tabular}
\caption{The conditional probability table of Vector\_2 given Vector\_1}
\label{vector2tab} 
\end{table}



\subsection{Using the Network}
In order to present the model in action, we can create a concrete example of the
model determining the direction/speed of the target.\nl

The turret starts its operation by looking straight ahead while waiting for the
target to appear. The target enters the turret's field of vision, and the turret
tracks the target. During the tracking, the turret observes the target at 3
locations, which in this case is an angle/distance pair: (9,104), (20,76) and
(46,65).\nl

This information is used as evidence for the model in Hugin, which allows
us to determine a probability for \texttt{Vector\_1} and \texttt{Vector\_2}
based on our test-data, which is presented in \autoref{AppendixMIData}. For
\texttt{Vector\_1}, given our 3 locations, this results in the following
probalities:

\begin{itemize}
  \item 80\% speed - 78.57\% chance.
  \item 60\% speed - 14.86\% chance.
  \item Bad Observation - 6.57\% chance.
\end{itemize}

In this case, the model would conclude that \texttt{Vector\_1} would be most
likely to have the target moving at 80\% speed. Now, given the same information,
the model would assign \texttt{Vector\_2} the following probabilities:

\begin{itemize}
  \item 80\% speed - 24.84\% chance.
  \item 60\% speed - 55.00\% chance.
  \item Bad Observation - 20.16\% chance.
\end{itemize}

The probability for \texttt{Vector\_2} indicates that the most likely conclusion
is that something went wrong with the data. This does not mean that the target's
behavior is unknown, but that the gathered data does not correlate to previous
experience. In case the two vectors do not reach the same conclusion, the
resulting speed will be based on the following reasoning:

\begin{table}[H]
\centering
\begin{tabular}{|l|l|}
\hline
Case                                                                                 & Conclusion \\ \hline
Both vectors agree                                                                   & Vector\_2  \\ \hline
The vectors disagree                                                                 & Vector\_2  \\ \hline
\begin{tabular}[c]{@{}l@{}}First vector is bad,\\ second vector is good\end{tabular} & Vector\_2  \\ \hline
\begin{tabular}[c]{@{}l@{}}First vector is good,\\ second vector is bad\end{tabular} & Vector\_1  \\ \hline
\end{tabular}
\caption{Speed conclusion based on vector\_1 and vector\_2.}
\end{table}

While this model may not always output the correct result, with enough previous
data to base the probabilities on, some of the cases of disagreement between the
vectors would be eliminated.



%This information is then able to flow to both of the vector
% nodes through the connections mentioned in \autoref{LabelBN}.
% 
% \figx[1.15]{BNEvidence}{The network with evidence on its sensor nodes.}
% 
% We can look at \texttt{Vector\_2} and find the most likely outcome of it, and
% see if it is likely to be a bad vector.


