\section{Turret Design}
The turret can be considered the product of 3 different design choices, the
shooting mechanism, the base and the sensor placement. These 3 parts of the
turret not only has to work on their own, but also come together as a whole.\nl

The final design of the turret uses a shooting mechanism with a piston
that pushes the projectile through a mouthpiece that clamps around it. The
piston is mounted on an angling mechanism, which is positioned on top of
the base. The NXT is mounted inside the base in order to distribute weight. Two
ultrasonic sensors and a camera are positioned on the front of the base,
allowing \name to track and measure the distance to a target. All of this sits
on a turning mechanism. This mechanism consists of a cog connected to a motor
which is placed on the outside, allowing the base to turn. The turret can be
seen in \autoref{turret}. 

\figx[0.16]{turret}{The final turret and its parts.}

In the following subsections the design process and arguments for the
design of each part will be presented.

\subsection{Design of the Shooting Mechanism}
The goal of the shooting mechanism is to be able to shoot at least
200 cm, as this is one of the requirements. It thus needs a lot of power behind
each shot. It also needs to be able to fire multiple times without reloading,
which can allow to fire again if it misses. Three different design were
considered:

\begin{itemize}
  \item A ballista design
  \item A launcher design
  \item A piston design
\end{itemize}

\begin{figure}[H]
\begin{minipage}{.31\textwidth}
\figx[0.4]{ballista}{A sketch of the ballista design.} 
\end{minipage}
\begin{minipage}{.29\linewidth}
\figx[0.4]{tennisball}{A sketch of the spinning wheel design.} 
\end{minipage}
\begin{minipage}{.29\linewidth}
\figx[0.45]{piston}{A sketch of the piston design.}
\end{minipage}
\end{figure}

The ballista design was considered as a ballista is able to deliver a lot of
power with each shot. Which can be seen in \autoref{ballista}.\nl

This design was quickly dismissed, as while it can deliver a lot power to each
shot, its rate of fire would be slow as it would be slow to reload. This would
mean that in case it missed, it would most likely not be able to try again.\nl

The launcher was considered, since it is able to lauch projectiles quickly and
with great force. It utilizes the same principle as a tennis ball launcher, two
wheels placed side by side spinning in opposite directions, with the projectile
pushed through. Which can be seen in \autoref{tennisball}.\nl

When trying to build this design it was determined that the available motors was
not powerful enough to deliver the necessary momentum for launching a
projectile, not even with a gearing. Another problem is that the wheels
available was made of soft rubber, which absorbs a lot of the force when the
projectile is pushed through. For this design to work the better, the wheels
would need to be made of a hard material that does not absorb the force from the
motor and has a lot of friction, which makes it easier for the wheels to
grip the projectile.\nl

The piston design uses a piston that pushes the projectile trough a mouth piece
that clamps around it. This means that until enough force has been applied to
the projectile it is held in the mouth piece. When enough force has been
applied by the piston, the projectile will be forced out at high speed. Which
can be seen in \autoref{piston}.\nl

This design has several advantages, Lego Technic has a ball launcher which can
store several small ball projectiles. This allows us to have an easily
reloadable and fast firing cannon which can hold up to 6 shots.\nl

Using this design a test to find how accurate it is at fireing the projectile
to the expected distance was conducted.
In this test the turret was set to an angle before fireing. The distance was
then measured by having the projectile landing in a layer of flour on the
ground. The test was conducted twice and the minimum and maximum distance was
plotted against the angle together with the best fit line, which is seen in
\autoref{graph:Accuracy}.
This shows that the turret is fairly accurate, since the points on
the graph somewhat follows a \fix{thirddegreepolynomial}{Cubic function?} as
expected.


\begin{graphEnv}
\begin{graphFloat}
\centering
\begin{tikzpicture}
	\begin{axis}[xlabel={Angle}, ylabel={Distance}, xmin=0,
	ymin=0,xmax=60,ymax=350, minor tick num = 3, /pgfplots/grid = both, axis lines
	= left,legend style={ at={(1.3,0.5)}, anchor=center}] 
	\addplot[blue] expression[domain=0:50,samples=300]{-0.0035*x^3 + 0.2498*x^2 -
	1.957*x + 114.27}; 
	\addlegendentry{Average}
	\addplot[red,only marks]table {data/DistVSAngleTestset1.dat}
	[xshift=4pt,yshift=8pt]
	node[pos=0]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.07]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.14]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.21]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.28]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.35]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.42]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.49]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.56]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.63]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.7]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.77]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.84]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.91]{%
		\pgfplotspointplotattime
		\footnotesize
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	node[pos=0.98]{%
		\pgfplotspointplotattime
		\footnotesize	
		$(\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/x}},
		\pgfmathprintnumber
		{\pgfkeysvalueof{/data point/y}})$
	}
	;
	\node at(400,340){\scriptsize$y=-0.0035*x^3 + 0.2498*x^2$};
	\node at(400,320){\scriptsize$-1.957*x + 114.27$};
	\node at(400,300){\scriptsize$R^2=0.682$};
	\addlegendentry{Data}
	\end{axis}
\end{tikzpicture}
\caption{Results from accuracy test}
\end{graphFloat}
\label{graph:Accuracy}
\end{graphEnv}

The reason for using this design is that it is able to shoot the desired
distance and is able to reload itself. The tests conducted in
\autoref{SensorTest} also shows that the sensors that \name makes use can not
sense any longer than the piston design can shoot, which makes the power that
the two other designs has obslete.\nl

The cannon is mounted on a mechanism that is used to angle it such that it
is able to shoot a target at varying distances. This mechanism works by having a
high gearing on a motor and connecting the platform that the shooting mechanism
is mounted on to the big gear. This makes the platform rise when the motor
turns.

\subsection{Design of the base}
The base of the turret is designed with two main requirements in mind: it should
be able to turn freely and it should be as stable as possible. This resulted
in the base being designed as a frame where the NXT is mounted and the shooting
and angling mechanism are mounted on the top. Two designs were considered for the frame: 

\begin{itemize}
  \item A design with the NXT mounted upright
  \item A design with the NXT mounted layig down
\end{itemize}

The reason for mounting the NXT on the base is that it would limit the movement
of the turret if it was not, since the wires available is not long enough to
allow it turn freely.\nl

In the upright design the screen and the buttons on the front
was accessible, but all the I/O ports on the end was hard to get to. This
design was not chosen. This is because of the additional height and the fact
that it is difficult to charge the NXT. The height is a factor due to the fact
that the taller the turret gets the more unstable it becomes. This is because
the base sits in on top of the turning mechanism, which is a narrow point. This
causes the turret to tilt slightly when it turns. This is a problem due to the
fact that if the turret were to make a fast turn it could be overthrown or be
slightly erratic. This design also placed a lot of the weight on one side of
turret which made it more unstable.\nl

In the laying down design the I/O ports are fully accessible. This design also makes the turret a
lot shorter and distributes the weight which makes the turret more stable. All
of these advantages leads us to choosing this design.

\subsection{Sensor Placement}
The sensors are a vital part of the turret and need to placed in such a way that
the results from the sensors are as good as possible. As the tests described in
\autoref{UltraTestPlacement} states, it is important that the ultrasoic sensors
are not placed to close to the ground due to the fact that it interferes with
the soundwaves. This makes the results imprecise and can potentially make the
turret unable to hit a target.\nl

The final design makes use of two ultrasonic sensors placed side by side since
it was determined that the field of view would be too narrow with only one
sensor. This is due to the fact that the ultrasonic sensor needs to be pointed
almost perpendicular at the target in order to catch the soundwaves that bounces
back. The use of two sensors brings up the problem of interference between the
two sensors but that was solved by alternating between turning on and off each
sensor so that when when one sensor is on the other one is off and vice
versa.\nl

\name also makes use of a camera to track a target. This camera is mounted on
the front of the base in the middle. This is to give the camera the best
view of the target. The camera is calibrated to track the colour red, as this
is the colour that the camera regognizes the most based on the tests in \autoref{CamTest}.

\subsection{Turning Mechanism}
The turret needs to be able to turn in order to be able to track a moving
target. For this purpose three designs were considered. 

\begin{itemize}
  \item A spiral gear design
  \item A direct connection design
  \item A gear design
\end{itemize}

In the spiral gear design a motor was placed beside the turret. This motor was
connected to a stick with a spiral gear that was conected to a gear on the bottom of the base. This design
made the turning of the turret precise in the sense that the turret was not
prone to over turning when stopping the motor. The problem with this design is
that it limits how much the turret can turn, due to the fact that the cable
connecting the motor to the NXT has to either go on the outside of the turret,
which makes it wrap around and in turn stop the turret from turning, or go on
the inside which makes the cable twist, which also makes the turret stop
turning, although it can turn more than with the cable on the outside.\nl

The direct connection design was considered since the motor was placed inside
the base of the turret and connected directly to the gear that makes the turret turn. This
design does not have the problem of the cable limiting how much the turret can
turn, since the motor is located on the the turret and therefore turns with the
NXT. This design does have a flaw, that is that it overturns whenever it needs
to stop. This is beacause the stick that is connected to the turning mechanism
is made of soft plastic, which makes it twist when the motor applies force to
it. When the tension in the plastic is great enough the turret begins to turn.
This means that when the motor stops the plastic will untwist which makes the
turret overturn. This means that the turret is very imprecise which makes it
difficult to aim correctly. This could be compensated for in the software by
calculating how much more the turret turns due to the plastic stick twisting,
but since this is difficult to measure and it is relative to how much force the motor applies it was deemed
not worth the effort, when it could also be solved by having a gear between
the motor and the turning mechanism.\nl

The gear design is similar to the design with the turret directly connected to
the gear that turns the turret, the difference being that the motor is placed on
the outside of the base and the motor is geared which makes it more precise when
stopping since it does not over turn as much as the design whitout a gear. 


