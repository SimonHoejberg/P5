\section{Ultrasonic Sensor Testing}\label{SensorTest}
The first sensor we need to test is the ultrasonic distance sensor. These tests
will be used to verify the contents of the technical specification, and
to gain a deeper understanding of how the sensor operates and what
problems could occur when using it. As such, the tests will consist of
clarifying the following points:
\begin{itemize}
  \item Where and how is the sensor best placed on the turret?
  \item What is the sensors maximum distance?
  \item At what distance is the data no longer accurate?
  \item How wide is the sensors 'cone of vision'? 
\end{itemize}

% 
% The two sensors used on the turret both have datasheets with technical
% documentation, but in order to verify this information, and to gain a
% deeper understanding of how to use these sensors, this section will be used to
% test their individual features. The first test in \autoref{UltraTest} will be
% used to determine the accuracy and limitations of the ultrasonic sensor. The second
% test in \autoref{CamTest} will be used to determine how the camera can best be
% used to identify a target, and how the resulting data can be accurately used. 

% First the
% testing methodology will be explained for each test, and then this methodology
% will be used to devise tests for the two sensors. 
% 
% In this chapter the different sensors will be tested, the reasoning for testing
% the sensors is that we need to find out how precise the sensors are and how far
% they can measure. There are two sensor which needs to be tested, one is an
% ultrasonic sensor which is used for measuring the distance. The other sensor
% which needs to be tested is a camera for tracking specific colours. We will then
% use the results from these test to utilize the full potential of the sensors. 
 
% To find out which sensors are the optimal
% sensors for the project, this chapter will be used to test the different sensors. The testing of the
% sensors will also be used to find out how precise they are.\nl
% % 
% First the testing methodology will be explained, then this methodology
% will be used to devise tests for the different sensors.

% \subsection{Testing Methodology}
% The testing will be divided into to two parts, one part is testing the two
% distance sensors and the second part is testing the camera.

\subsection{Ultrasonic Sensor Test - Setup}\label{UltraTestSetup}
The setup for testing the ultrasonic sensor consists of placing the turret on
the floor along a wall, and pointing towards a target at varying distances along
the wall. This wall is marked with a number of lines each representing a
distance of 10cm from the turret's location. The target for this test is a
rectangular cardboard cutout, which is used to hold a sheet of coloured paper
which is folded around it. This setup can be seen in
\autoref{SensorUltraSetup.JPG}.

\figx[0.1]{SensorUltraSetup.JPG}{The test setup for testing the ultrasonic
distance sensor.}

\subsection{Ultrasonic Sensor Test - Placement}\label{UltraTestPlacement}
The first test consists of determining where on the turret the sensor should be
placed. The purpose of this test is to optimize the quality of the data which
the sensor collects, and to help determine some design choices for the
turret.\nl

% This test was concucted by placing the ultrasonic sensor at different places on
% the turret, and then testing the sensors maximum distance. As the test was done
% as a part of the initial turret design, it does not include any formalized data
% sets. As such, these were the conclusions which could be drawn:\nl

\subsubsection{Using Blinders}
At first when testing the ultrasonic sensors, it was determined that the
sensor's ability to accurately measure the distance was subject to interferance
by the surroundings. In effect this vastly reduced the maximum distace of the
sensor, and as such, a lot of different attempts were made in order to solve
this problem. As this was done as a part of the initial design phase, the
different turret designs were not recorded. These tests resulted in the
following conclusion:\nl

\textit{\textbf{The ultrasonic sensors can use blinders to increase their
maximum sensing distance.}}\nl

In order to determine the importance of using blinders, this subsection will be
used to present data which compares the distance tests of the ultrasonic sensor,
both with and without blinders.

\graphL{Actual distance [cm]}{Measured distance
[cm]}{shieldedBoxStanding,shieldedBoxLandscape}{Box Standing, Box
Landscape}{Results with a shielded sensor and a box h.
14.2cm and w. 9cm}{shieldedTestBox}

\graphL{Actual distance [cm]}{Measured distance
[cm]}{unshieldedBoxStanding,unshieldedBoxLandscape}{Box Standing, Box
Landscape}{Results with a unshielded sensor and a box h.
14.2cm and w. 9cm}{unshieldedTestBox}

\graphL{Actual distance [cm]}{Measured distance
[cm]}{shieldedPaperStanding,shieldedPaperLandscape}{Paper Standing, Paper
Landscape}{Results with a shielded sensor and a A4 Paper}{shieldedTestPaper}

\graphL{Actual distance [cm]}{Measured distance
[cm]}{unshieldedPaperStanding,unshieldedPaperLandscape}{Paper Standing, Paper
Landscape}{Results with a unshielded sensor and a A4 Paper}{unshieldedTestPaper}


As seen in \autoref{graph:shieldedTestBox}, \autoref{graph:unshieldedTestBox},
\autoref{graph:unshieldedTestPaper} and \autoref{graph:shieldedTestPaper} the
sensor was able to determine the distance with better precision when it is
shielded and the object was in the landscape position. \nl

It can then be concluded that the shielded sensor performed a lot better than
the unshielded, it can also be concluded that the placement of the object can
have a big impact. This is due to the fact that the sensor does not have a very
large field of view. Therefore, the object should be wider rather than taller. 

\subsubsection{Additional Design notes}
These tests also found the following conclusion:\nl

The sensor should not be placed close to the ground. While testing it was
determined that the sensor should not be placed close to the ground, as this
resulted in a vast degredation of the data. Compared to the technical
specification which stated that the maximum range is 255cm, this design resulted
in a maximum distance of ~100cm.\nl

\subsection{Ultrasonic Sensor Test - Distance}
The second test on the ultrasonic sensor is designed to determine the accuracy
of the sensors measurements compared to the actual distance. As such, the test
was conducted using test setup explained in \autoref{UltraTestSetup} using the
two ultrasonic sensors. The measurements were done at varying distances with an
interval of 25cm, and were measured 5 times at each distance. The results from
this test is presented below in \autoref{UltDistTestDat}. The complete data sets
can be found in \autoref{UltraDistTestData}.

\dataTable{UltrasonicDistanceTestData}{Average measured distance compared to
the actual distance.}{UltDistTestDat}


\dataTable{SensorCamTest1}{Data from test 1. (With background)}{CamTest1}



\subsection{Ultrasonic Sensor Test - Cone of Vision}
The data has been collected, but there is nothing here yet!


% The test of the ultrasonic sensor was divided into 4 different experiments, the
% difference between the experiments are the size of the object being tracked and
% whether the sensor is shielded or not. The different object sizes was tested
% with a shielded sensor and a non shielded sensor. \nl



% \subsection{Infrared}
% The test of the infrared sensor was not able to be conducted since there were
% some issues with the different sensors. The first sensor did not work at all.
% Since it was an infrared sensor, a camera was used to see if the infrared
% LED lid up. Since it did not light we concluded that the sensor was broken. \nl
% 
% When trying to test the other sensor, first it did not give a reading so the
% same test was conducted using a camera to see if the sensor was broken. It was
% concluded that the sensor was not broken. It was then discovered that it was a
% problem with the software, where the address for the reading the sensor on the
% I2C port was changed. This meant that it was not possible to get a proper
% reading. The readings were either 0 or a reading above 60.000 depending on which
% port was used. \nl
% 
% Another issue with using the infrared sensor is the range. The medium range
% infrared sensor only has a range from 10 to 80 cm. Therefore this sensor could
% become a very limiting factor in regards to how far the target can be placed
% from the cannon. 

\subsection{Camera Sensor Test}\label{CamTest}%Will most likely need a better
Testing the camera will consist of trying to answer two main questions. Namely
what colours can be easily recognized, and at what distance can the target be
identified. As such, this subsection will consist of a test setup, the resulting
data and the conclusions which can be drawn from this data.

\subsubsection{Camera Test - Setup}\label{CamTestSetup}
The setup for testing the camera consists of placing the turret at one end of a
long table, pointing towards a target at the other end. The table is marked with
a number of lines each representing a distance of 25cm from the turret's
location. The target for this test is a rectangular cardboard cutout, which is
used to hold a sheet of coloured paper which is folded around it. Behind the
coloured paper is a dark background which is used in some, but not all tests.
This setup can be seen in \autoref{SensorCamSetup.JPG}.

\figx[0.1]{SensorCamSetup.JPG}{Setup for the camera test (With Background).}

\subsubsection{Camera Test Results - Colours}\label{CamTestColours}
In order to determine what colour can best be detected, the target wrapped with
a piece of coloured paper, and is then placed at a distance of 2m from the
turret. The camera is then used to search for the specified colour. As explained
in \autoref{SensTheoCam} this data consists of rectangular segments of the
identified colour, and these segments sizes and colours. The quality of the
individual colours is determined by looking at two factors. The first factor is
the consistancy of the recorded data, which is determined by the variance in the
data. The second factor is the cameras ability to keep recognizing the target
at different distances.\nl

The first test looks at the consistancy of the recorded data. To do this we look
at three main points. The maximum and minimum measured areas, the difference
between these points, and the average measured area. In addition each colour is
given a rating based on the amount of frames where a colour was recognized.
These ratings are: Ok (~70-100\%), bad (~40-69\%), very bad (~20-39\%) and Null
(No data). It should also be noted that the results from this test have been
observed through the NXTCam calibration software, and that the data points have
been manually observed and written down. The test was done twice, once with a
background of a contrasting colour, and one without. The results from the first
test can be seen in \autoref{table:CamTest1}.



From the data presented in \autoref{table:CamTest1} we can conclude the
following:
\begin{itemize}
  \item The blue and yellow colours can not be recognized
  \item The green colour has the hightest variance of 163 pixels
  \item The green colour has a low amount of frames with recognition
  \item The red colour has the lowest variance of 19 pixels
  \item Of the 'ok' colours, orange and red, orange has the largest measured
  average area.
\end{itemize} 

Based on these conclusions we can determine that the best colours would be
either red or orange. In order to verify this assumption the test is repeated
without the contrasting background. The results from the second test can be seen
in \autoref{table:CamTest2}.

\dataTable{SensorCamTest2}{Data from test 2. (Without background)}{CamTest2}

From the data presented in \autoref{table:CamTest2} we can conclude the
following:
\begin{itemize}
  \item For some colours the contrasting background gives worse data
  \item Given no contrasting background 'yellow' can be seen, but the data is
  'bad'
  \item Given no contrasting background 'red' can no longer be recognized
  \item Given no contrasting background 'orange' has no variance in data
\end{itemize} 

Based on these conclusions we can determine that orange would be colour of
choice, as the camera is capable of recognizing the colour without any variance
in the recorded data.

\subsubsection{Camera Test Results - Distance}\label{CamTestDistance}
Based on the choice made in \autoref{CamTestColours} to use orange as the colour
of the target, this section will be used to further determine how well this
colour can be used at different distances. For this purpose, the target will be
placed at various distances from the target, as noted in \autoref{CamTestSetup}.
The measurements will use the same ratings 'ok', 'bad', 'very bad' and 'null',
as described in \autoref{CamTestColours}. The resulting data from this test can be
seen in \autoref{table:CamTest3}. 

\dataTable{SensorCamTest3}{Quality of data at different distances.}{CamTest3}

The data presented in \autoref{table:CamTest3} represents the camera's ability
to recognize the target at different distances, but during the testing a major
flaw was identified. It was found that the the measured colour of the target
changes based on its distance from the turret and the light levels at its
current location. In effect this means that no single colour can be used to
recognize the target at all distances, but instead multiple colours need to be
recognized based on the distance to the target. This problem has two identified
solutions, either the camera is programmed to recognize a number of different
shades of orange, or the turret will be limited to only operate in well and
consistently lit areas. The solution to this problem will be further explored
as part of the final implementation in \autoref{}.

% several parts, these parts will heavily rely
% on the technical specifications of the camera. Therefore the first part of this
% section will be on the technical specifications of the camera and the needed
% software.\nl
% 
% The camera runs at 30 fps and with a resolution of 88 x 144. This could
% potentialy become an issue due to the fact that it is a very low resolution.
% Although this is a could be a problem, it depends on how large the
% object/objects being tracked are.
% The camera also has the ability to track up to 8 different objects
% \fix{\Source}{Kan vi refere til de tekniske specfikationer i user guide}. \nl
% 
% The setup of the camera is quite simple and is done using a computer, to setup
% which color it is suposed to track. The process of choosing the color is done
% using some software that comes with the camera, here a colormap is made which
% tells the preprocessor on the camera which colors to track. 
% 
% There are three different test that can be done, the first to 
% determine which colour the camera best sees, the second to see how
% far the camera can track an object and the third to determine if lighting up the
% object changed the cameras abillity to track the colour \/ object.\nl
% 
% The first test is to determine what colour the camera best can see, to do this
% a square of paper with the same size will be used to make sure that the only
% diffence is the colour of the paper. The setup of the test is that the camera
% should stay at the same place so that the lighting condition stays the same,
% then the paper square is place at a certain distance to the camera. The result
% of each test is how many blobs of the tracking was the recordnised and how
% consisten the size of the coloured blob is.\nl
% 
% The second test, to test how far the camera can track objects is to do this the
% turret it setup in the same manner as the test before, here the object which is
% the paper is moved further and further away, optional could the colours of the
% paper be changed to see how well the different colours can be seen from a
% distance. The results of this test is the distance that the camera can see each
% colour and again how consisten it is.\nl
% 
% The third test, to test weather lighting up the object with an flashlight
% improves how well the camera sees the object, again this test needs to bed setup
% in the same manner at the two other test with the turret in the same place
% thoughout the test and then the test pocedes as test 2 with observering how far
% away it can see the object and as a result determine if the flashlight is
% nessery and what colour works best with it.
% 